var result = require('d4-roshamresult');
var app;
exports.initialize = function(theApp){
	app=theApp;
}



exports.contactConnectedSockets = function(theData){
	console.log('in contact, turn date:');
	for (connection in app.io.connected){
		if (app.io.connected.hasOwnProperty(connection)){
			//get the turn info here...
			console.log(app.io.handshaken[connection].session);
			result.getUserTurnResults({turnDate : theData.turnDate, userID : app.io.handshaken[connection].session.userID},
				function(data){
					console.log('in the callback from contactConnectedSockets');
					app.io.sockets.sockets[connection].emit('turnResult', {who: 'god', what : 'I see you ' + app.io.handshaken[connection].session.displayName});
			});
			//send them a message
		}
	}
}