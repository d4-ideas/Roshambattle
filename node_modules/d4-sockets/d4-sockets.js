var result = require('d4-roshamresult');
var app;
exports.initialize = function(theApp){
	app=theApp;
}

exports.contactConnectedSockets = function(theData){
	var sessionMap={};
	for (connection in app.io.connected){
		if (app.io.connected.hasOwnProperty(connection)){
			sessionMap[app.io.handshaken[connection].session.userID] = app.io.sockets.sockets[connection];
			//get the turn info here...
			result.getUserTurnResults({turnDate : theData.turnDate, userID : app.io.handshaken[connection].session.userID},
				function(data1, data2){
					sessionMap[data2.userID].emit('getOneTurn', data2);
			});
		}
	}
}